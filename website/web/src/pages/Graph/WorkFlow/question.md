# 工作流页面问题


## 鼠标右击的位置问题、节点面板、工具栏、鼠标移动节点有点卡顿
问题描述：鼠标右击节点弹窗的位置问题、节点面板无法拖拽、工具栏按钮无法使用、鼠标移动节点有点卡顿
时间：2025-08-03
状态：已解决

1. 鼠标右击节点时位置不正确 - ✅ 已解决
   - 修复了右键菜单位置计算逻辑，现在会显示在节点正下方
   - 使用节点的 getBoundingClientRect() 获取准确位置
   - 调整了菜单的水平居中显示

2. 最左侧的节点面板（节点类型 WorkflowSidebar）还是无法通过鼠标拖拽生成在画布上 - ✅ 已解决
   - 改进了拖拽事件处理，添加了更多视觉反馈
   - 使用 ref 获取准确的 ReactFlow 容器位置
   - 确保正确设置了 dataTransfer 数据

3. 最上侧的工具栏（WorkflowToolbar）的删除、添加等按钮、无法使用 - ✅ 已解决
   - 实现了工具栏按钮的功能
   - 添加了删除选中元素的功能
   - 添加了添加新节点的功能
   - 添加了自动布局的功能（基础实现）

4. 鼠标移动节点有点卡顿 - ✅ 已解决
   - 优化了 CSS，移除了不必要的过渡效果
   - 添加了 will-change: transform 提高变换性能
   - 优化了边缘的事件处理
   - 使用 lodash-es 的 debounce 函数优化节点位置更新
   - 减少了不必要的重绘和重排

## 拖拽问题 和 节点操作问题
问题描述：拖拽问题 和 节点操作问题
时间：2025-08-03
状态：已解决

1. 拖拽节点时、画布上并不会生效 - ✅ 已解决
   - 修复了节点位置更新逻辑，在 useWorkflowControls 中正确处理 position 变更
   - 确保节点可以正常拖拽和移动
   - 使用 lodash-es 的 debounce 函数优化节点位置更新，减少状态更新频率

2. 鼠标右击节点时、没有出现一些操作按钮、比如删除、复制、或者添加边 - ✅ 已解决
   - 添加了节点右键菜单功能
   - 实现了删除、复制、添加连接、编辑等操作
   - 使用 Ant Design 的 Dropdown 和 Menu 组件实现

3. 选中的节点、也不能使用快捷键进行操作 - ✅ 已解决
   - 添加了键盘快捷键支持
   - 支持 Delete/Backspace 删除选中元素
   - 支持 Ctrl+D 复制选中节点
   - 支持 Ctrl+C/V 复制粘贴功能（基础实现）
   - 支持 Ctrl+Z/Y 撤销重做功能（基础实现）